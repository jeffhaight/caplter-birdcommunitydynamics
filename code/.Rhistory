knitr::opts_chunk$set(
echo = FALSE,
warning = FALSE,
include = TRUE,
cache = TRUE
)
rm(list = ls())
gc()
library(tidyverse)
library(beepr)  # for notifying you when some code is  done running
# for statistical modeling
library(performance)  # for checking model performance (multicollinearity, VIF, overdispersion, etc.)
library(insight)      # for extracting a lot of useful model information, using functions like 'get_variance()'
library(lme4)
library(glmmTMB)
library(lmerTest)     # for getting p-values out of the lmer models
library(MuMIn)        # for calculating R^2, among other things
library(vegan)        # for multivariate community analyses
library(jagsUI)       # for running Bayesian models in JAGS
library(mgcv)         # for GAM(M)s
library(itsadug)      # for GAMM plotting
# for plotting
# library(ggplot2)      # should already be in the 'tidyverse'
library(ggpubr)       # for adding correlations and p-values to ggplot
library(ggeffects)    # for plotting glmm effects in ggplot
library(ggcorrplot)   # for correlation plots
library(GGally)       # similar to ggcorrplot
library(gghighlight)  # for highlighting groups in ggplot
library(RColorBrewer)
list.files("~/GitHub/caplter-birdcommunitydynamics/data")
# This contains data assembled by the '2_1_StatisticalModelingSetup_CAPbirds' file
load("~/GitHub/caplter-birdcommunitydynamics/data/modelinputs_CAPbirds2024.RData")
data.win$site_code <- as.factor(data.spr$site_code)
data.spr$site_code <- as.factor(data.spr$site_code)
set.seed(54321)
# cor(data.win$temp_max, data.win$temp_min)
# cor(data.win$temp_max_prevsum, data.win$temp_min_prevsum)
# now try that with different covariates
m.abund.winter <- glmmTMB(abundance ~
# time
year_std +   # year as a continuous variable
# current env. conditions
NDBI_std +
NDVI_std +
LST_std +
ppt_sum_std +
# interactions between current env. conditions
NDBI_std*NDVI_std +
NDBI_std*LST_std +
NDBI_std*ppt_sum_std +
# recent env conditions
NDVI_prevsum_std +
LST_prevsum_std +
ppt_sum_prevsum_std +
# some potential interaction effects
# year_std * NDBI_std +
# year_std * LST_std +
# year_std * LST_prevsum_std +
# year_std * ppt_sum_std +
# year_std * ppt_sum_prevsum_std +
# year_std * NDVI_prevsum_std +
# (1 |site_code)
(1 + year_std|site_code) ##+ (1|id)
, data = data.win,
family = nbinom2
)
# check_overdispersion(m.abund.winter)
# check_collinearity(m.abund.winter)
# round(confint(m.abund.winter), 3)
# ranef(m.abund.spring)
# r2(m.abund.winter)
summary(m.abund.winter)
AIC(m.abund.winter)
